from Nettacker.interface import *
import  os

if __name__  == "__main__":
	#The vulnerability scanner takes as input an IP address, or a list of IP addresses  to scan
	nmap_path = nmap3.get_nmap_path()
	#requires nmap to run,  scan takes  3-5 min to complete depends on how  many ips are given
	if os.path.exists(nmap_path):
		demo = Vulnerability_Scanner(['10.2.0.3','10.2.0.6','10.2.0.4'])
		demo.type1_scan()
		print('\n')
		print('#'*30)
		print('Pre-defined vulnerability test  scan  done!')
		print('Continuing type2 scan......')
		demo.type2_scan()
		print('\n')
		print('CVE local lookup scan done, all reports saved')
		print('\n')
		print('Now displaying the demo scan result json file:')
		data = json.load(open(demo.log_in_file))
		for item  in data:
			print('{}:{}    {}--->{}'.format(item['HOST'],item['PORT'],item['TYPE'],item['DESCRIPTION']))
		print('\n'*5)
		print('Now displaying a more comprehensive scan result, scanned by Vulscan:')

		data = json.load(open('./'+demo.targets[0]+'.json'))
		print('These are all the  open ports: ')
		print(data['open_ports'].keys())
		print('An example of a port->service version and associated vulnerabilities:')
		print('Port 80/tcp -> '+data['open_ports']['80/tcp'])
		print('\n'*2)
		print('Exiting.........')
		sys.exit(0)

		
	else:
		raise nmap3.exceptions.NmapNotInstalledError()
		